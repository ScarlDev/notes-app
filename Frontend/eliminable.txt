INFORMACION TECNICA DEL PROYECTO FLUTTER - PUEDE ELIMINARSE

=== ARQUITECTURA ===

El proyecto sigue el patron MVVM (Model-View-ViewModel) con Clean Architecture:

1. MODELS (lib/models/)
   - User: Modelo de usuario con fromJson/toJson
   - Note: Modelo de nota con fromJson/toJson
   - Representan las entidades de datos

2. PROVIDERS (lib/providers/)
   - AuthProvider: Maneja el estado de autenticacion
     * login() - Inicia sesion y guarda el token
     * register() - Registra usuario y guarda el token
     * logout() - Elimina el token y limpia el estado
     * checkAuthStatus() - Verifica si hay token guardado
   
   - NotesProvider: Maneja el estado de las notas
     * fetchNotes() - Obtiene todas las notas del usuario
     * createNote() - Crea una nueva nota
     * deleteNote() - Elimina una nota
   
   Los providers extienden ChangeNotifier para notificar cambios a la UI

3. SCREENS (lib/screens/)
   - LoginScreen: Pantalla de inicio de sesion con validacion
   - RegisterScreen: Pantalla de registro con validacion
   - HomeScreen: Lista de notas con swipe-to-delete y creacion

4. CORE (lib/core/)
   - api_client.dart: Cliente Dio con interceptores
   - constants.dart: Constantes de configuracion

=== DIO INTERCEPTOR ===

El ApiClient configura Dio con un interceptor que:
1. Intercepta cada peticion (onRequest)
2. Lee el token de flutter_secure_storage
3. Si existe token, añade header: Authorization: Bearer <token>
4. Continua con la peticion

Esto asegura que todas las peticiones a endpoints protegidos incluyan el token automaticamente.

=== FLUTTER SECURE STORAGE ===

Se usa para guardar el JWT de forma segura:
- Android: Usa KeyStore
- iOS: Usa Keychain

Metodos principales:
- write(): Guarda el token
- read(): Lee el token
- delete(): Elimina el token

=== GO_ROUTER ===

Sistema de navegacion declarativa con:
- Rutas: /, /register, /home
- Redirect logic: Verifica autenticacion y redirige apropiadamente
  * Usuario no autenticado + ruta protegida = Redirige a login
  * Usuario autenticado + ruta de login = Redirige a home

=== FLUJO DE AUTENTICACION ===

1. REGISTRO:
   - Usuario completa formulario (name, email, password)
   - Se valida con validadores de Flutter
   - Se llama a AuthProvider.register()
   - POST /api/auth/register
   - Backend retorna { user, token }
   - Token se guarda en secure storage
   - Estado isAuthenticated = true
   - Router redirige a /home

2. LOGIN:
   - Usuario completa formulario (email, password)
   - Se valida con validadores de Flutter
   - Se llama a AuthProvider.login()
   - POST /api/auth/login
   - Backend retorna { user, token }
   - Token se guarda en secure storage
   - Estado isAuthenticated = true
   - Router redirige a /home

3. ACCESO A NOTAS:
   - Usuario entra a HomeScreen
   - initState llama a NotesProvider.fetchNotes()
   - GET /api/notes
   - El interceptor añade automaticamente: Authorization: Bearer <token>
   - Backend verifica token y retorna notas del usuario
   - UI se actualiza con la lista de notas

4. CREAR NOTA:
   - Usuario hace tap en FloatingActionButton
   - Se muestra dialogo con campos title y content
   - Usuario completa y presiona Create
   - Se llama a NotesProvider.createNote()
   - POST /api/notes con { title, content }
   - Interceptor añade token automaticamente
   - Backend crea nota y retorna nota creada
   - Provider añade la nueva nota al inicio de la lista
   - UI se actualiza automaticamente

5. ELIMINAR NOTA (SWIPE-TO-DELETE):
   - Usuario desliza nota de derecha a izquierda
   - Widget Dismissible detecta gesto
   - Se llama a NotesProvider.deleteNote(noteId)
   - DELETE /api/notes/:id
   - Interceptor añade token automaticamente
   - Backend verifica ownership y elimina
   - Provider elimina la nota de la lista local
   - UI se actualiza automaticamente
   - Se muestra SnackBar confirmando eliminacion

6. LOGOUT:
   - Usuario hace tap en icono de logout
   - Se llama a AuthProvider.logout()
   - Token se elimina de secure storage
   - Estado se limpia (user = null, isAuthenticated = false)
   - Router detecta cambio y redirige a /

=== VALIDACION DE FORMULARIOS ===

Se usa GlobalKey<FormState> con TextFormField:
- validator: Funcion que retorna String? (null = valido)
- Validaciones implementadas:
  * Email: No vacio y contiene @
  * Password: Minimo 6 caracteres
  * Name: Minimo 2 caracteres

=== MANEJO DE ESTADO CON PROVIDER ===

Provider se usa para:
1. Compartir estado entre widgets
2. Notificar cambios automaticamente
3. Rebuild solo widgets que escuchan cambios

Dos formas de acceder:
- context.watch<T>(): Escucha cambios y rebuild
- context.read<T>(): Solo lectura, sin rebuild

=== CONFIGURACION PARA ANDROID (ADB REVERSE) ===

Para que la app Android se conecte a localhost:3000:

1. Conectar dispositivo/emulador
2. Ejecutar: adb reverse tcp:3000 tcp:3000
3. Ahora http://127.0.0.1:3000 en la app apunta al backend en tu PC

Alternativa: Usar IP local (192.168.x.x:3000)

=== DEPENDENCIAS ===

provider: ^6.1.1
- State management oficial de Flutter
- Ligero y recomendado por el equipo de Flutter

dio: ^5.4.0
- Cliente HTTP avanzado
- Soporte para interceptores, transformadores, etc

flutter_secure_storage: ^9.0.0
- Almacenamiento seguro multiplataforma
- USA KeyStore/Keychain nativos

go_router: ^13.0.0
- Router declarativo moderno
- Soporte para deep linking y navegacion compleja

=== ESTRUCTURA DE CARPETAS ===

Frontend/
├── lib/
│   ├── core/
│   │   ├── api_client.dart
│   │   └── constants.dart
│   ├── models/
│   │   ├── user.dart
│   │   └── note.dart
│   ├── providers/
│   │   ├── auth_provider.dart
│   │   └── notes_provider.dart
│   ├── screens/
│   │   ├── login_screen.dart
│   │   ├── register_screen.dart
│   │   └── home_screen.dart
│   └── main.dart
├── pubspec.yaml
└── analysis_options.yaml

=== COMANDOS IMPORTANTES ===

# Instalar dependencias
flutter pub get

# Ejecutar app
flutter run

# Ejecutar en dispositivo especifico
flutter run -d <device_id>

# Ver dispositivos disponibles
flutter devices

# Configurar adb reverse (Android)
adb reverse tcp:3000 tcp:3000

# Build APK
flutter build apk

=== MEJORAS PARA PRODUCCION ===

1. Manejo de errores mas robusto (try-catch especificos)
2. Logging con paquetes como logger
3. Pruebas unitarias y de integracion
4. Internacionalizacion (i18n)
5. Temas claro/oscuro
6. Paginacion para listas grandes
7. Offline support con cache local
8. Pull-to-refresh en lista de notas (ya implementado RefreshIndicator)
9. Animaciones y transiciones mejoradas
10. Edicion de notas (actualmente solo crear/eliminar)

=== NOTAS IMPORTANTES ===

1. El baseUrl usa 127.0.0.1 (localhost)
   - Para Android real: Usar adb reverse o IP local
   - Para iOS simulator: 127.0.0.1 funciona directamente

2. Los interceptores añaden el token automaticamente
   - No necesitas añadir headers manualmente en cada peticion
   - El token se lee de secure storage en cada request

3. La navegacion con go_router es declarativa
   - El redirect se ejecuta en cada cambio de ruta
   - checkAuthStatus se llama para verificar token

4. Provider notifica cambios automaticamente
   - Usa notifyListeners() despues de cambiar estado
   - Los widgets con watch() se rebuilden automaticamente

5. Swipe-to-delete usa Dismissible widget
   - direction: DismissDirection.endToStart (solo deslizar a izquierda)
   - background: Widget que aparece detras al deslizar
   - onDismissed: Callback cuando se completa el gesto
